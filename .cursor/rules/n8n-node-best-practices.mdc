---
description:
globs:
alwaysApply: false
---
# Правила для разработки кастомных нодов n8n

## Основной файл
- Главный модуль нода — [FileToJsonNode.node.js](mdc:FileToJsonNode.node.js).
- Весь функционал по обработке файлов реализован в этом файле.

## Интеграция с n8n
- Класс должен реализовывать интерфейс IExecuteFunctions из пакета n8n-workflow.
- Экспортируйте объект с ключом, соответствующим имени нода, например:
  ```js
  module.exports = { FileToJsonNode };
  ```
- Описание нода (description) должно содержать displayName, name, icon, group, version, inputs, outputs, properties.
- Для корректной работы в n8n, файл должен быть размещён в папке custom нодов или подключён через настройку n8n.

## Стиль и структура кода
- Вспомогательные функции рекомендуется выносить в отдельные файлы (например, helpers.js) для повышения читаемости и тестируемости.
- Используйте асинхронные методы для работы с файлами и внешними библиотеками.
- Обрабатывайте ошибки через try/catch и возвращайте информативные сообщения для пользователя.
- Для логирования используйте встроенный логгер n8n (this.logger), чтобы сообщения попадали в системные логи.

## Расширяемость
- Для поддержки новых форматов файлов используйте паттерн "стратегии" — отдельная функция/класс для каждого формата.
- Все зависимости должны быть явно указаны в package.json с фиксированными версиями.

## Документирование
- README.md должен содержать описание назначения, поддерживаемых форматов, примеры входных и выходных данных, инструкции по установке и интеграции.
- Описывайте ограничения и возможные ошибки.

## Тестирование
- Для сложных функций добавляйте юнит-тесты (например, через jest или mocha).
- Храните тестовые файлы для разных форматов в отдельной папке (например, /test/files).

## Безопасность
- Проверяйте входные данные на корректность.
- Не допускайте выполнение стороннего кода или небезопасных операций при обработке файлов.

---
Эти правила основаны на текущем коде, возможностях платформы n8n и официальной документации. Следуйте им для повышения качества, удобства поддержки и успешной интеграции кастомных нодов в n8n workflow.
